<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .inputBox {
            width: 200px;
        }

        ul {
            width: 200px;
            height: 400px;
            overflow: hidden;
            margin: 0;
            padding: 0;
            list-style-type: none;
        }
    </style>
</head>

<body>
    <div id="searchComponent">
        <input type="text" class="inputBox">
        <button class="searchBar">搜索</button>
    </div>
</body>
<script>
    let inputBox = document.querySelector('#searchComponent input');
    let searchComponent = document.querySelector('#searchComponent');

    // function debounce(fn, delay) {
    //     let timer = null;
    //     return function (args) {
    //         //获取函数的作用域和变量
    //         let that = this
    //         let _args = args
    //         //每次事件被触发，都会清除当前的timer，然后重写设置超时调用
    //         if (timer) clearTimeout(timer)
    //         timer = setTimeout(function () {
    //             fn.call(that, _args)
    //         }, delay)
    //     }
    // }


    //一定时间内重复触发，只触发最后一次
    function debounce(fn, delay) {
        let timer = null;
        return function (...args) {
            if (timer) clearTimeout(timer);
            timer = setTimeout(() => {
                fn.apply(this, args);
            }, delay)
        }
    }

    //触发过后，冷却一定时间
    function throttle(fn, delay) {
        let timer = null;
        let frist = true;
        return function () {
            //存在timer即为冷却时间

            if (timer) return;
            //timer不存在，

            timer = setTimeout(() => {
                flag = false;
                fn();
                clearTimeout(timer);
            }, delay)
            if (flag) fn();
        }
    }

    function inputBoxMatch(e) {
        //删除以前的ul
        let oldul = document.querySelector('#searchComponent ul')
        if (oldul) searchComponent.removeChild(oldul);
        //获取文本值
        let value = e.target.value;
        //设置正则表达式
        let reg = RegExp(`${value}`);
        //获得匹配数组
        let matchers = history.filter((item) => {
            return reg.test(item);
        })
        //创建新节点
        let ul = document.createElement('ul');
        //遍历添加上去
        matchers.forEach((item) => {
            let li = document.createElement('li');
            li.innerText = item;
            ul.appendChild(li);
        })
        //最后添加到外层容器上
        searchComponent.appendChild(ul);
    }
    //防抖
    let inputBoxMatchDe = debounce(inputBoxMatch, 500);
    //搜索历史模拟
    let history = [
        '前端', '前端实习', '大前端', '李白', '杜甫', '白居易', '前端开发'
    ]
    //监听input框
    inputBox.addEventListener('input', inputBoxMatchDe)
</script>

</html>